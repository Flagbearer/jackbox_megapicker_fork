{"version":3,"file":"integrations.js","sources":["../src/integrations.ts"],"sourcesContent":["/* eslint-disable deprecation/deprecation */\nimport { Integration } from '@sentry/types';\nimport { dynamicRequire } from '@sentry/utils';\n\nimport { ElectronOptions } from './';\nimport {\n  AdditionalContext,\n  ChildProcess,\n  ElectronBreadcrumbs,\n  ElectronMinidump,\n  MainContext,\n  MainProcessSession,\n  OnUncaughtException,\n  PreloadInjection,\n  Screenshots,\n  SentryMinidump,\n} from './main/integrations';\nimport { EventToMain, ScopeToMain } from './renderer/integrations';\n\n/** Convenience interface used to expose Integrations */\nexport interface Integrations {\n  // For main process\n  SentryMinidump: typeof SentryMinidump;\n  ElectronMinidump: typeof ElectronMinidump;\n  ElectronBreadcrumbs: typeof ElectronBreadcrumbs;\n  MainContext: typeof MainContext;\n  OnUncaughtExcept: typeof OnUncaughtException;\n  PreloadInjection: typeof PreloadInjection;\n  MainProcessSession: typeof MainProcessSession;\n  AdditionalContext: typeof AdditionalContext;\n  ChildProcess: typeof ChildProcess;\n  Screenshots: typeof Screenshots;\n  // For renderer process\n  ScopeToMain: typeof ScopeToMain;\n  // eslint-disable-next-line deprecation/deprecation\n  EventToMain: EventToMain;\n}\n\n/** Return all Electron integrations and add EmptyIntegrations for integrations missing in this process. */\nexport function getIntegrations(): Integrations {\n  return process.type === 'browser'\n    ? {\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n        ...dynamicRequire(module, './main').Integrations,\n        ScopeToMain: EmptyIntegration,\n        EventToMain: EmptyIntegration,\n      }\n    : {\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n        ...dynamicRequire(module, './renderer').Integrations,\n        SentryMinidump: EmptyIntegration,\n        ElectronMinidump: EmptyIntegration,\n        ElectronBreadcrumbs: EmptyIntegration,\n        MainContext: EmptyIntegration,\n        OnUncaughtExcept: EmptyIntegration,\n        PreloadInjection: EmptyIntegration,\n        MainProcessSession: EmptyIntegration,\n        AdditionalContext: EmptyIntegration,\n        ChildProcess: EmptyIntegration,\n        Screenshots: EmptyIntegration,\n      };\n}\n\n/**\n * The EmptyIntegration gets loaded when the requested integration cannot be used in the current Electron process\n *\n * This allows you to call the same code from both Electron processes and not have to conditionally compile\n *\n * ```\n * const { init, Integrations } = require('@sentry/electron');\n *\n * init({\n *   dsn: process.env.DSN,\n *   integrations: [new Integrations.ElectronMinidump()],\n * });\n *\n */\nclass EmptyIntegration implements Integration {\n  /** @inheritDoc */\n  public static id = 'EmptyIntegration';\n\n  /** @inheritDoc */\n  public readonly name: string;\n\n  public constructor() {\n    this.name = EmptyIntegration.id;\n  }\n\n  /** @inheritDoc */\n  public setupOnce(): void {\n    //\n  }\n}\n\n/** Filters out any EmptyIntegrations that are found */\nexport function removeEmptyIntegrations(options: Partial<ElectronOptions>): void {\n  if (Array.isArray(options.integrations)) {\n    options.integrations = options.integrations.filter((i) => i.name !== EmptyIntegration.id);\n  } else if (typeof options.integrations === 'function') {\n    const originalFn = options.integrations;\n\n    options.integrations = (integrations) => {\n      const userIntegrations = originalFn(integrations);\n      return userIntegrations.filter((integration) => integration.name !== EmptyIntegration.id);\n    };\n  }\n}\n"],"names":[],"mappings":";;AAsCA;SACgB,eAAe,GAAA;AAC7B,IAAA,OAAO,OAAO,CAAC,IAAI,KAAK,SAAS;AAC/B,UAEO,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,EAAA,EAAA,cAAc,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC,YAAY,CAChD,EAAA,EAAA,WAAW,EAAE,gBAAgB,EAC7B,WAAW,EAAE,gBAAgB,EAAA,CAAA,GAEhC,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,EAAA,EAEM,cAAc,CAAC,MAAM,EAAE,YAAY,CAAC,CAAC,YAAY,CAAA,EAAA,EACpD,cAAc,EAAE,gBAAgB,EAChC,gBAAgB,EAAE,gBAAgB,EAClC,mBAAmB,EAAE,gBAAgB,EACrC,WAAW,EAAE,gBAAgB,EAC7B,gBAAgB,EAAE,gBAAgB,EAClC,gBAAgB,EAAE,gBAAgB,EAClC,kBAAkB,EAAE,gBAAgB,EACpC,iBAAiB,EAAE,gBAAgB,EACnC,YAAY,EAAE,gBAAgB,EAC9B,WAAW,EAAE,gBAAgB,GAC9B,CAAC;AACR,CAAC;AAED;;;;;;;;;;;;;AAaG;AACH,MAAM,gBAAgB,CAAA;AAOpB,IAAA,WAAA,GAAA;AACE,QAAA,IAAI,CAAC,IAAI,GAAG,gBAAgB,CAAC,EAAE,CAAC;KACjC;;IAGM,SAAS,GAAA;;KAEf;;AAbD;AACc,gBAAE,CAAA,EAAA,GAAG,kBAAkB,CAAC;AAexC;AACM,SAAU,uBAAuB,CAAC,OAAiC,EAAA;IACvE,IAAI,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,YAAY,CAAC,EAAE;QACvC,OAAO,CAAC,YAAY,GAAG,OAAO,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,IAAI,KAAK,gBAAgB,CAAC,EAAE,CAAC,CAAC;AAC3F,KAAA;AAAM,SAAA,IAAI,OAAO,OAAO,CAAC,YAAY,KAAK,UAAU,EAAE;AACrD,QAAA,MAAM,UAAU,GAAG,OAAO,CAAC,YAAY,CAAC;AAExC,QAAA,OAAO,CAAC,YAAY,GAAG,CAAC,YAAY,KAAI;AACtC,YAAA,MAAM,gBAAgB,GAAG,UAAU,CAAC,YAAY,CAAC,CAAC;AAClD,YAAA,OAAO,gBAAgB,CAAC,MAAM,CAAC,CAAC,WAAW,KAAK,WAAW,CAAC,IAAI,KAAK,gBAAgB,CAAC,EAAE,CAAC,CAAC;AAC5F,SAAC,CAAC;AACH,KAAA;AACH;;;;"}