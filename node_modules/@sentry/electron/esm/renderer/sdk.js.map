{"version":3,"file":"sdk.js","sources":["../../src/renderer/sdk.ts"],"sourcesContent":["/* eslint-disable no-restricted-globals */\nimport {\n  BrowserOptions,\n  defaultIntegrations as defaultBrowserIntegrations,\n  init as browserInit,\n} from '@sentry/browser';\nimport { logger } from '@sentry/utils';\n\nimport { ensureProcess, RendererProcessAnrOptions } from '../common';\nimport { enableAnrRendererMessages } from './anr';\nimport { metricsAggregatorIntegration } from './integrations/metrics-aggregator';\nimport { scopeToMainIntegration } from './integrations/scope-to-main';\nimport { electronRendererStackParser } from './stack-parse';\nimport { makeRendererTransport } from './transport';\n\nexport const defaultIntegrations = [\n  // eslint-disable-next-line deprecation/deprecation\n  ...defaultBrowserIntegrations,\n  scopeToMainIntegration(),\n  metricsAggregatorIntegration(),\n];\n\ninterface ElectronRendererOptions extends BrowserOptions {\n  /**\n   * Enables ANR detection in this renderer process.\n   *\n   * Optionally accepts an object of options to configure ANR detection.\n   *\n   * {\n   *   pollInterval: number; // Defaults to 1000ms\n   *   anrThreshold: number; // Defaults to 5000ms\n   *   captureStackTrace: boolean; // Defaults to false\n   * }\n   *\n   * Defaults to 'false'.\n   */\n  anrDetection?: Partial<RendererProcessAnrOptions> | boolean;\n}\n\n/**\n * Initialize Sentry in the Electron renderer process\n * @param options SDK options\n * @param originalInit Optional init function for a specific framework SDK\n * @returns\n */\nexport function init<O extends ElectronRendererOptions>(\n  options: ElectronRendererOptions & O = {} as ElectronRendererOptions & O,\n  // This parameter name ensures that TypeScript error messages contain a hint for fixing SDK version mismatches\n  originalInit: (if_you_get_a_typescript_error_ensure_sdks_use_version_v7_112_0: O) => void = browserInit,\n): void {\n  ensureProcess('renderer');\n\n  // Ensure the browser SDK is only init'ed once.\n  if (window?.__SENTRY__RENDERER_INIT__) {\n    logger.warn(`The browser SDK has already been initialized.\nIf init has been called in the preload and contextIsolation is disabled, is not required to call init in the renderer`);\n    return;\n  }\n\n  window.__SENTRY__RENDERER_INIT__ = true;\n\n  // We don't want browser session tracking enabled by default because we already have Electron\n  // specific session tracking from the main process.\n  if (options.autoSessionTracking === undefined) {\n    options.autoSessionTracking = false;\n  }\n\n  // Disable client reports for renderer as the sdk should only send\n  // events using the main process.\n  options.sendClientReports = false;\n\n  if (options.defaultIntegrations === undefined) {\n    options.defaultIntegrations = defaultIntegrations;\n  }\n\n  if (options.stackParser === undefined) {\n    options.stackParser = electronRendererStackParser;\n  }\n\n  if (options.dsn === undefined) {\n    // Events are sent via the main process but browser SDK wont start without dsn\n    options.dsn = 'https://12345@dummy.dsn/12345';\n  }\n\n  if (options.transport === undefined) {\n    options.transport = makeRendererTransport;\n  }\n\n  if (options.anrDetection) {\n    enableAnrRendererMessages(options.anrDetection === true ? {} : options.anrDetection);\n  }\n\n  // We only handle initialScope in the main process otherwise it can cause race conditions over IPC\n  delete options.initialScope;\n\n  originalInit(options);\n}\n"],"names":["defaultBrowserIntegrations","browserInit"],"mappings":";;;;;;;;;AAAA;AAea,MAAA,mBAAmB,GAAG;;AAEjC,IAAA,GAAGA,qBAA0B;AAC7B,IAAA,sBAAsB,EAAE;AACxB,IAAA,4BAA4B,EAAE;EAC9B;AAmBF;;;;;AAKG;AACa,SAAA,IAAI,CAClB,OAAA,GAAuC,EAAiC;AACxE;AACA,YAAA,GAA4FC,MAAW,EAAA;IAEvG,aAAa,CAAC,UAAU,CAAC,CAAC;;AAG1B,IAAA,IAAI,MAAM,KAAN,IAAA,IAAA,MAAM,uBAAN,MAAM,CAAE,yBAAyB,EAAE;QACrC,MAAM,CAAC,IAAI,CAAC,CAAA;AACsG,qHAAA,CAAA,CAAC,CAAC;QACpH,OAAO;AACR,KAAA;AAED,IAAA,MAAM,CAAC,yBAAyB,GAAG,IAAI,CAAC;;;AAIxC,IAAA,IAAI,OAAO,CAAC,mBAAmB,KAAK,SAAS,EAAE;AAC7C,QAAA,OAAO,CAAC,mBAAmB,GAAG,KAAK,CAAC;AACrC,KAAA;;;AAID,IAAA,OAAO,CAAC,iBAAiB,GAAG,KAAK,CAAC;AAElC,IAAA,IAAI,OAAO,CAAC,mBAAmB,KAAK,SAAS,EAAE;AAC7C,QAAA,OAAO,CAAC,mBAAmB,GAAG,mBAAmB,CAAC;AACnD,KAAA;AAED,IAAA,IAAI,OAAO,CAAC,WAAW,KAAK,SAAS,EAAE;AACrC,QAAA,OAAO,CAAC,WAAW,GAAG,2BAA2B,CAAC;AACnD,KAAA;AAED,IAAA,IAAI,OAAO,CAAC,GAAG,KAAK,SAAS,EAAE;;AAE7B,QAAA,OAAO,CAAC,GAAG,GAAG,+BAA+B,CAAC;AAC/C,KAAA;AAED,IAAA,IAAI,OAAO,CAAC,SAAS,KAAK,SAAS,EAAE;AACnC,QAAA,OAAO,CAAC,SAAS,GAAG,qBAAqB,CAAC;AAC3C,KAAA;IAED,IAAI,OAAO,CAAC,YAAY,EAAE;AACxB,QAAA,yBAAyB,CAAC,OAAO,CAAC,YAAY,KAAK,IAAI,GAAG,EAAE,GAAG,OAAO,CAAC,YAAY,CAAC,CAAC;AACtF,KAAA;;IAGD,OAAO,OAAO,CAAC,YAAY,CAAC;IAE5B,YAAY,CAAC,OAAO,CAAC,CAAC;AACxB;;;;"}