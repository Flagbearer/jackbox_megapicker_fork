{"version":3,"file":"scope-to-main.js","sources":["../../../src/renderer/integrations/scope-to-main.ts"],"sourcesContent":["import { convertIntegrationFnToClass, defineIntegration, getCurrentScope } from '@sentry/core';\nimport { normalize } from '@sentry/utils';\n\nimport { getIPC } from '../ipc';\n\nconst INTEGRATION_NAME = 'ScopeToMain';\n\n/**\n * Passes scope changes to the main process.\n */\nexport const scopeToMainIntegration = defineIntegration(() => {\n  return {\n    name: INTEGRATION_NAME,\n    setupOnce() {\n      // noop\n    },\n    setup() {\n      const scope = getCurrentScope();\n      if (scope) {\n        const ipc = getIPC();\n\n        scope.addScopeListener((updatedScope) => {\n          ipc.sendScope(JSON.stringify(normalize(updatedScope.getScopeData(), 20, 2_000)));\n          scope.clearBreadcrumbs();\n          scope.clearAttachments();\n        });\n      }\n    },\n  };\n});\n\n/**\n * Passes scope changes to the main process.\n *\n * @deprecated Use `scopeToMainIntegration()` instead\n */\n// eslint-disable-next-line deprecation/deprecation\nexport const ScopeToMain = convertIntegrationFnToClass(INTEGRATION_NAME, scopeToMainIntegration);\n"],"names":[],"mappings":";;;;AAKA,MAAM,gBAAgB,GAAG,aAAa,CAAC;AAEvC;;AAEG;AACU,MAAA,sBAAsB,GAAG,iBAAiB,CAAC,MAAK;IAC3D,OAAO;AACL,QAAA,IAAI,EAAE,gBAAgB;QACtB,SAAS,GAAA;;SAER;QACD,KAAK,GAAA;AACH,YAAA,MAAM,KAAK,GAAG,eAAe,EAAE,CAAC;AAChC,YAAA,IAAI,KAAK,EAAE;AACT,gBAAA,MAAM,GAAG,GAAG,MAAM,EAAE,CAAC;AAErB,gBAAA,KAAK,CAAC,gBAAgB,CAAC,CAAC,YAAY,KAAI;oBACtC,GAAG,CAAC,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,YAAY,CAAC,YAAY,EAAE,EAAE,EAAE,EAAE,IAAK,CAAC,CAAC,CAAC,CAAC;oBACjF,KAAK,CAAC,gBAAgB,EAAE,CAAC;oBACzB,KAAK,CAAC,gBAAgB,EAAE,CAAC;AAC3B,iBAAC,CAAC,CAAC;AACJ,aAAA;SACF;KACF,CAAC;AACJ,CAAC,EAAE;AAEH;;;;AAIG;AACH;AACa,MAAA,WAAW,GAAG,2BAA2B,CAAC,gBAAgB,EAAE,sBAAsB;;;;"}