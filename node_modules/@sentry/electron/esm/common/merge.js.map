{"version":3,"file":"merge.js","sources":["../../src/common/merge.ts"],"sourcesContent":["import { Event } from '@sentry/types';\nimport deepMerge from 'deepmerge';\n\n/** Removes private properties from event before merging */\nfunction removePrivateProperties(event: Event): void {\n  for (const span of event.spans || []) {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    delete (span as any).spanRecorder;\n    // eslint-disable-next-line deprecation/deprecation\n    delete span.transaction;\n  }\n}\n\n/** Merges Events with defaults */\nexport function mergeEvents(defaults: Event, event: Event): Event {\n  removePrivateProperties(event);\n\n  const newEvent: Event = deepMerge(defaults, event);\n\n  // We need to copy spans across manually\n  //\n  // Spans contain a custom toJSON function for serialization and without\n  // this they are serialised with camelCase properties rather than the\n  // snake_case required by the Sentry API.\n  if (event.spans || defaults.spans) {\n    newEvent.spans = event.spans || defaults.spans;\n  }\n\n  // We don't want packages array in sdk to get merged with duplicates\n  return {\n    ...newEvent,\n    sdk: {\n      ...defaults.sdk,\n      ...event.sdk,\n    },\n  };\n}\n"],"names":[],"mappings":";;AAGA;AACA,SAAS,uBAAuB,CAAC,KAAY,EAAA;IAC3C,KAAK,MAAM,IAAI,IAAI,KAAK,CAAC,KAAK,IAAI,EAAE,EAAE;;QAEpC,OAAQ,IAAY,CAAC,YAAY,CAAC;;QAElC,OAAO,IAAI,CAAC,WAAW,CAAC;AACzB,KAAA;AACH,CAAC;AAED;AACgB,SAAA,WAAW,CAAC,QAAe,EAAE,KAAY,EAAA;IACvD,uBAAuB,CAAC,KAAK,CAAC,CAAC;IAE/B,MAAM,QAAQ,GAAU,SAAS,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;;;;;;AAOnD,IAAA,IAAI,KAAK,CAAC,KAAK,IAAI,QAAQ,CAAC,KAAK,EAAE;QACjC,QAAQ,CAAC,KAAK,GAAG,KAAK,CAAC,KAAK,IAAI,QAAQ,CAAC,KAAK,CAAC;AAChD,KAAA;;IAGD,OACK,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,EAAA,EAAA,QAAQ,CACX,EAAA,EAAA,GAAG,EACE,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,EAAA,EAAA,QAAQ,CAAC,GAAG,CACZ,EAAA,KAAK,CAAC,GAAG,CAEd,EAAA,CAAA,CAAA;AACJ;;;;"}